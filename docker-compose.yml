services:
  airbridge-gateway:
    # Für lokales Testen: build lokal, für Production: image von GHCR verwenden
    build:
      context: .
      dockerfile: Dockerfile
    # image: ghcr.io/bernardteske/airbridge:latest  # Kommentiere aus für lokales Build
    container_name: airbridge-gateway
    restart: unless-stopped
    environment:
      - MQTT_BROKER_HOST=${MQTT_BROKER_HOST:-mosquitto}
      - MQTT_BROKER_PORT=${MQTT_BROKER_PORT:-1883}
      - MQTT_USERNAME=${MQTT_USERNAME:-}
      - MQTT_PASSWORD=${MQTT_PASSWORD:-}
      - CONFIG_PATH=/app/config/devices.json
    volumes:
      - ./config/devices.json:/app/config/devices.json:ro
    # Bridge-Netzwerk für Zugriff auf Host-Netzwerk (ESP-Geräte)
    # Standard-Bridge-Netzwerk hat Zugriff auf das Host-Netzwerk
    network_mode: bridge
    # Falls MQTT-Broker auf Host läuft, verwende host.docker.internal
    # Ansonsten MQTT_BROKER_HOST auf die Container-IP oder Service-Name setzen

